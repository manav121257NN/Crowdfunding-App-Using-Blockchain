{"ast":null,"code":"import{useEffect,useState,useCallback}from\"react\";import{ethers}from\"ethers\";import{useNavigate}from\"react-router-dom\";import{getContract}from\"../connectWallet\";import\"../css/AllCampaigns.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AllCampaigns(){const[campaigns,setCampaigns]=useState([]);const[loading,setLoading]=useState(true);const[filter,setFilter]=useState(\"open\");const navigate=useNavigate();const fetchCampaigns=useCallback(async()=>{setLoading(true);try{const contract=await getContract();if(!contract)return;const raw=await contract.getAllCampaigns();const parsed=raw.map((c,i)=>{const goal=Number(ethers.utils.formatEther(c.goal));const raised=Number(ethers.utils.formatEther(c.fundsRaised));const closed=c.completed||raised>=goal;return{id:i,title:c.title,description:c.description,imageUrl:c.imageUrl,owner:c.owner,goal,raised,closed,progress:Math.min(raised/goal*100,100),createdAt:new Date(c.createdAt.toNumber()*1000).toLocaleDateString()};}).reverse();setCampaigns(parsed);}catch(err){console.error(\"Fetch error:\",err);}finally{setLoading(false);}},[]);useEffect(()=>{fetchCampaigns();},[fetchCampaigns]);const visibleCampaigns=campaigns.filter(c=>{if(filter===\"open\")return!c.closed;if(filter===\"closed\")return c.closed;return true;});return/*#__PURE__*/_jsxs(\"div\",{className:\"campaigns-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"filter-container\",children:[/*#__PURE__*/_jsx(\"button\",{className:`filter-btn ${filter===\"open\"?\"active\":\"\"}`,onClick:()=>setFilter(\"open\"),children:\"Active\"}),/*#__PURE__*/_jsx(\"button\",{className:`filter-btn ${filter===\"all\"?\"active\":\"\"}`,onClick:()=>setFilter(\"all\"),children:\"All\"}),/*#__PURE__*/_jsx(\"button\",{className:`filter-btn ${filter===\"closed\"?\"active\":\"\"}`,onClick:()=>setFilter(\"closed\"),children:\"Completed\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"campaigns-grid\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-state\",children:\"Loading blockchain data\\u2026\"}),!loading&&visibleCampaigns.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-state\",children:\"No campaigns found\"}),!loading&&visibleCampaigns.map(c=>/*#__PURE__*/_jsxs(\"div\",{className:\"campaign-card\",onClick:()=>navigate(`/campaign/${c.id}`),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-image-wrapper\",children:[/*#__PURE__*/_jsx(\"img\",{src:c.imageUrl,alt:c.title,className:\"card-img\"}),/*#__PURE__*/_jsx(\"span\",{className:`status-badge ${c.closed?\"closed\":\"open\"}`,children:c.closed?\"Completed\":\"Active\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"card-title\",children:c.title}),/*#__PURE__*/_jsx(\"p\",{className:\"card-desc\",children:c.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"progress-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"progress-labels\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"raised-val\",children:[c.raised,\" ETH\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"goal-val\",children:[\"of \",c.goal,\" ETH\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-track\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill\",style:{width:`${c.progress}%`}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"creator-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar-placeholder\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"creator-address\",children:[c.owner.slice(0,6),\"\\u2026\"]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"date-tag\",children:c.createdAt})]})]})]},c.id))]}),/*#__PURE__*/_jsx(\"button\",{className:\"refresh-fab\",onClick:fetchCampaigns,title:\"Refresh\",children:\"\\u21BB\"})]});}export default AllCampaigns;","map":{"version":3,"names":["useEffect","useState","useCallback","ethers","useNavigate","getContract","jsx","_jsx","jsxs","_jsxs","AllCampaigns","campaigns","setCampaigns","loading","setLoading","filter","setFilter","navigate","fetchCampaigns","contract","raw","getAllCampaigns","parsed","map","c","i","goal","Number","utils","formatEther","raised","fundsRaised","closed","completed","id","title","description","imageUrl","owner","progress","Math","min","createdAt","Date","toNumber","toLocaleDateString","reverse","err","console","error","visibleCampaigns","className","children","onClick","length","src","alt","style","width","slice"],"sources":["C:/Users/manav/OneDrive/Desktop/test crowdfund/Crowdfunding-App-Using-Blockchain/Fronted/src/components/AllCampaigns.jsx"],"sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { getContract } from \"../connectWallet\";\r\nimport \"../css/AllCampaigns.css\";\r\n\r\nfunction AllCampaigns() {\r\n  const [campaigns, setCampaigns] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [filter, setFilter] = useState(\"open\");\r\n  const navigate = useNavigate();\r\n\r\n  const fetchCampaigns = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const contract = await getContract();\r\n      if (!contract) return;\r\n\r\n      const raw = await contract.getAllCampaigns();\r\n\r\n      const parsed = raw\r\n        .map((c, i) => {\r\n          const goal = Number(ethers.utils.formatEther(c.goal));\r\n          const raised = Number(ethers.utils.formatEther(c.fundsRaised));\r\n          const closed = c.completed || raised >= goal;\r\n\r\n          return {\r\n            id: i,\r\n            title: c.title,\r\n            description: c.description,\r\n            imageUrl: c.imageUrl,\r\n            owner: c.owner,\r\n            goal,\r\n            raised,\r\n            closed,\r\n            progress: Math.min((raised / goal) * 100, 100),\r\n            createdAt: new Date(c.createdAt.toNumber() * 1000).toLocaleDateString(),\r\n          };\r\n        })\r\n        .reverse();\r\n\r\n      setCampaigns(parsed);\r\n    } catch (err) {\r\n      console.error(\"Fetch error:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchCampaigns();\r\n  }, [fetchCampaigns]);\r\n\r\n  const visibleCampaigns = campaigns.filter(c => {\r\n    if (filter === \"open\") return !c.closed;\r\n    if (filter === \"closed\") return c.closed;\r\n    return true;\r\n  });\r\n\r\n  return (\r\n    <div className=\"campaigns-page\">\r\n      {/* HEADER */}\r\n      <div className=\"header-section\">\r\n\r\n        <div className=\"filter-container\">\r\n          <button\r\n            className={`filter-btn ${filter === \"open\" ? \"active\" : \"\"}`}\r\n            onClick={() => setFilter(\"open\")}\r\n          >\r\n            Active\r\n          </button>\r\n          <button\r\n            className={`filter-btn ${filter === \"all\" ? \"active\" : \"\"}`}\r\n            onClick={() => setFilter(\"all\")}\r\n          >\r\n            All\r\n          </button>\r\n          <button\r\n            className={`filter-btn ${filter === \"closed\" ? \"active\" : \"\"}`}\r\n            onClick={() => setFilter(\"closed\")}\r\n          >\r\n            Completed\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* GRID */}\r\n      <div className=\"campaigns-grid\">\r\n        {loading && <div className=\"loading-state\">Loading blockchain data…</div>}\r\n\r\n        {!loading && visibleCampaigns.length === 0 && (\r\n          <div className=\"loading-state\">No campaigns found</div>\r\n        )}\r\n\r\n        {!loading &&\r\n          visibleCampaigns.map(c => (\r\n            <div\r\n              key={c.id}\r\n              className=\"campaign-card\"\r\n              onClick={() => navigate(`/campaign/${c.id}`)}\r\n            >\r\n              <div className=\"card-image-wrapper\">\r\n                <img src={c.imageUrl} alt={c.title} className=\"card-img\" />\r\n                <span className={`status-badge ${c.closed ? \"closed\" : \"open\"}`}>\r\n                  {c.closed ? \"Completed\" : \"Active\"}\r\n                </span>\r\n              </div>\r\n\r\n              <div className=\"card-content\">\r\n                <h3 className=\"card-title\">{c.title}</h3>\r\n                <p className=\"card-desc\">{c.description}</p>\r\n\r\n                <div className=\"progress-section\">\r\n                  <div className=\"progress-labels\">\r\n                    <span className=\"raised-val\">{c.raised} ETH</span>\r\n                    <span className=\"goal-val\">of {c.goal} ETH</span>\r\n                  </div>\r\n                  <div className=\"progress-track\">\r\n                    <div\r\n                      className=\"progress-fill\"\r\n                      style={{ width: `${c.progress}%` }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"card-footer\">\r\n                  <div className=\"creator-info\">\r\n                    <div className=\"avatar-placeholder\" />\r\n                    <span className=\"creator-address\">\r\n                      {c.owner.slice(0, 6)}…\r\n                    </span>\r\n                  </div>\r\n                  <span className=\"date-tag\">{c.createdAt}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n      </div>\r\n\r\n      {/* REFRESH */}\r\n      <button className=\"refresh-fab\" onClick={fetchCampaigns} title=\"Refresh\">\r\n        ↻\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AllCampaigns;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}