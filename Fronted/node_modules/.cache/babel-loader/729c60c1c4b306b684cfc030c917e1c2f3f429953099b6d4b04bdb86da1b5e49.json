{"ast":null,"code":"import{useEffect,useState}from\"react\";import{getContract,connectWallet}from\"../connectWallet\";import{ethers}from\"ethers\";import{useNavigate}from\"react-router-dom\";import\"../css/MyCampaigns.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function MyCampaigns(){const[campaigns,setCampaigns]=useState([]);const[isLoading,setIsLoading]=useState(false);const[userAddress,setUserAddress]=useState(\"\");const navigate=useNavigate();const fetchMyCampaigns=async()=>{setIsLoading(true);try{const contract=await getContract();if(!contract)return;const signer=await connectWallet();const addr=signer?(await signer.getAddress()).toLowerCase():\"\";setUserAddress(addr);const campaignsData=await contract.getAllCampaigns();const formattedCampaigns=campaignsData.map((campaign,index)=>{const goal=ethers.utils.formatEther(campaign.goal);const fundsRaised=ethers.utils.formatEther(campaign.fundsRaised);const progressPercentage=Math.min(parseFloat(fundsRaised)/parseFloat(goal)*100,100);return{id:index,owner:campaign.owner.toLowerCase(),title:campaign.title,description:campaign.description,goal,fundsRaised,completed:campaign.completed,imageUrl:campaign.imageUrl,progressPercentage,createdAt:new Date(campaign.createdAt.toNumber()*1000).toLocaleDateString()};});// FILTER: Only keep campaigns where owner matches current wallet\nconst myCampaigns=formattedCampaigns.filter(campaign=>campaign.owner===addr).sort((a,b)=>b.id-a.id);// Newest first\nsetCampaigns(myCampaigns);}catch(error){console.error(\"Error fetching my campaigns:\",error);}setIsLoading(false);};useEffect(()=>{fetchMyCampaigns();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"my-campaigns-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-section\"}),/*#__PURE__*/_jsx(\"div\",{className:\"campaigns-grid\",children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loading-state\",children:\"Loading your campaigns...\"}):campaigns.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCC2\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Campaigns Found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You haven't started any crowdfunding campaigns yet.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"create-btn-empty\",onClick:()=>navigate(\"/create\"),children:\"Create Your First Campaign\"})]}):campaigns.map(campaign=>{const isClosed=campaign.completed||parseFloat(campaign.fundsRaised)>=parseFloat(campaign.goal);return/*#__PURE__*/_jsxs(\"div\",{className:\"campaign-card\",onClick:()=>navigate(`/campaign/${campaign.id}`),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-image-wrapper\",children:[/*#__PURE__*/_jsx(\"img\",{src:campaign.imageUrl,alt:campaign.title,className:\"card-img\"}),/*#__PURE__*/_jsx(\"span\",{className:`status-badge ${isClosed?\"closed\":\"open\"}`,children:isClosed?\"Completed\":\"Active\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"card-title\",children:campaign.title}),/*#__PURE__*/_jsx(\"p\",{className:\"card-desc\",children:campaign.description.length>80?campaign.description.substring(0,80)+\"...\":campaign.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"progress-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"progress-labels\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"raised-val\",children:[campaign.fundsRaised,\" ETH\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"goal-val\",children:[\"of \",campaign.goal,\" ETH\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-track\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill\",style:{width:`${campaign.progressPercentage}%`}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"role-tag\",children:\"Owner (You)\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"date-tag\",children:[\"Created: \",campaign.createdAt]})]})]})]},campaign.id);})}),/*#__PURE__*/_jsx(\"button\",{className:\"refresh-fab\",onClick:fetchMyCampaigns,title:\"Refresh Data\",children:\"\\u21BB\"})]});}export default MyCampaigns;","map":{"version":3,"names":["useEffect","useState","getContract","connectWallet","ethers","useNavigate","jsx","_jsx","jsxs","_jsxs","MyCampaigns","campaigns","setCampaigns","isLoading","setIsLoading","userAddress","setUserAddress","navigate","fetchMyCampaigns","contract","signer","addr","getAddress","toLowerCase","campaignsData","getAllCampaigns","formattedCampaigns","map","campaign","index","goal","utils","formatEther","fundsRaised","progressPercentage","Math","min","parseFloat","id","owner","title","description","completed","imageUrl","createdAt","Date","toNumber","toLocaleDateString","myCampaigns","filter","sort","a","b","error","console","className","children","length","onClick","isClosed","src","alt","substring","style","width"],"sources":["C:/Users/manav/OneDrive/Desktop/test crowdfund/Crowdfunding-App-Using-Blockchain/Fronted/src/components/MyCampaigns.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { getContract, connectWallet } from \"../connectWallet\";\r\nimport { ethers } from \"ethers\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"../css/MyCampaigns.css\";\r\n\r\nfunction MyCampaigns() {\r\n  const [campaigns, setCampaigns] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [userAddress, setUserAddress] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  const fetchMyCampaigns = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const contract = await getContract();\r\n      if (!contract) return;\r\n\r\n      const signer = await connectWallet();\r\n      const addr = signer ? (await signer.getAddress()).toLowerCase() : \"\";\r\n      setUserAddress(addr);\r\n\r\n      const campaignsData = await contract.getAllCampaigns();\r\n\r\n      const formattedCampaigns = campaignsData.map((campaign, index) => {\r\n        const goal = ethers.utils.formatEther(campaign.goal);\r\n        const fundsRaised = ethers.utils.formatEther(campaign.fundsRaised);\r\n        const progressPercentage = Math.min(\r\n          (parseFloat(fundsRaised) / parseFloat(goal)) * 100,\r\n          100\r\n        );\r\n        \r\n        return {\r\n          id: index,\r\n          owner: campaign.owner.toLowerCase(),\r\n          title: campaign.title,\r\n          description: campaign.description,\r\n          goal,\r\n          fundsRaised,\r\n          completed: campaign.completed,\r\n          imageUrl: campaign.imageUrl,\r\n          progressPercentage,\r\n          createdAt: new Date(campaign.createdAt.toNumber() * 1000).toLocaleDateString(),\r\n        };\r\n      });\r\n\r\n      // FILTER: Only keep campaigns where owner matches current wallet\r\n      const myCampaigns = formattedCampaigns.filter(\r\n        (campaign) => campaign.owner === addr\r\n      ).sort((a, b) => b.id - a.id); // Newest first\r\n\r\n      setCampaigns(myCampaigns);\r\n    } catch (error) {\r\n      console.error(\"Error fetching my campaigns:\", error);\r\n    }\r\n    setIsLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchMyCampaigns();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"my-campaigns-page\">\r\n      <div className=\"header-section\">\r\n        \r\n      </div>\r\n\r\n      <div className=\"campaigns-grid\">\r\n        {isLoading ? (\r\n          <div className=\"loading-state\">Loading your campaigns...</div>\r\n        ) : campaigns.length === 0 ? (\r\n          <div className=\"empty-state\">\r\n            <div className=\"empty-icon\">ðŸ“‚</div>\r\n            <h3>No Campaigns Found</h3>\r\n            <p>You haven't started any crowdfunding campaigns yet.</p>\r\n            <button className=\"create-btn-empty\" onClick={() => navigate(\"/create\")}>\r\n              Create Your First Campaign\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          campaigns.map((campaign) => {\r\n            const isClosed =\r\n              campaign.completed ||\r\n              parseFloat(campaign.fundsRaised) >= parseFloat(campaign.goal);\r\n\r\n            return (\r\n              <div\r\n                key={campaign.id}\r\n                className=\"campaign-card\"\r\n                onClick={() => navigate(`/campaign/${campaign.id}`)}\r\n              >\r\n                {/* Image Section */}\r\n                <div className=\"card-image-wrapper\">\r\n                  <img src={campaign.imageUrl} alt={campaign.title} className=\"card-img\" />\r\n                  <span className={`status-badge ${isClosed ? \"closed\" : \"open\"}`}>\r\n                    {isClosed ? \"Completed\" : \"Active\"}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* Content Section */}\r\n                <div className=\"card-content\">\r\n                  <div className=\"card-header\">\r\n                    <h3 className=\"card-title\">{campaign.title}</h3>\r\n                    <p className=\"card-desc\">\r\n                      {campaign.description.length > 80 \r\n                        ? campaign.description.substring(0, 80) + \"...\" \r\n                        : campaign.description}\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Progress Section */}\r\n                  <div className=\"progress-section\">\r\n                    <div className=\"progress-labels\">\r\n                      <span className=\"raised-val\">{campaign.fundsRaised} ETH</span>\r\n                      <span className=\"goal-val\">of {campaign.goal} ETH</span>\r\n                    </div>\r\n                    <div className=\"progress-track\">\r\n                      <div \r\n                        className=\"progress-fill\" \r\n                        style={{ width: `${campaign.progressPercentage}%` }}\r\n                      ></div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Footer */}\r\n                  <div className=\"card-footer\">\r\n                    <span className=\"role-tag\">Owner (You)</span>\r\n                    <span className=\"date-tag\">Created: {campaign.createdAt}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })\r\n        )}\r\n      </div>\r\n\r\n      <button className=\"refresh-fab\" onClick={fetchMyCampaigns} title=\"Refresh Data\">\r\n        â†»\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MyCampaigns;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}